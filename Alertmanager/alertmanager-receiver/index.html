



<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
        <link rel="canonical" href="https://docs.prometheus.cool/Alertmanager/alertmanager-receiver/">
      
      
      
        <meta name="lang:clipboard.copy" content="å¤åˆ¶">
      
        <meta name="lang:clipboard.copied" content="å·²å¤åˆ¶">
      
        <meta name="lang:search.language" content="jp">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="æ²¡æœ‰æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„ç»“æœ">
      
        <meta name="lang:search.result.one" content="æ‰¾åˆ° 1 ä¸ªç¬¦åˆæ¡ä»¶çš„ç»“æœ">
      
        <meta name="lang:search.result.other" content="# ä¸ªç¬¦åˆæ¡ä»¶çš„ç»“æœ">
      
        <meta name="lang:search.tokenizer" content="[\uff0c\u3002]+">
      
      <link rel="shortcut icon" href="../../assets/img/prometheus_logo.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.0.2">
    
    
      
        <title>Receiveré…ç½® - äº‘åŸç”Ÿç›‘æ§ç¥å™¨Prometheus</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.982221ab.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.224b79ff.css">
      
      
        
        
        <meta name="theme-color" content="#ef5350">
      
    
    
      <script src="../../assets/javascripts/modernizr.1f0bcf2b.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,400i,700|Ubuntu+Mono">
        <style>body,input{font-family:"Ubuntu","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Ubuntu Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../assets/styles/extra.css">
    
      <link rel="stylesheet" href="../../assets/styles/prism.css">
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="red" data-md-color-accent="red">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#_1" tabindex="1" class="md-skip">
        è·³è½¬è‡³
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://docs.prometheus.cool" title="äº‘åŸç”Ÿç›‘æ§ç¥å™¨Prometheus" class="md-header-nav__button md-logo">
          
            <img src="../../assets/img/prometheus_logo.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              äº‘åŸç”Ÿç›‘æ§ç¥å™¨Prometheus
            </span>
            <span class="md-header-nav__topic">
              Receiveré…ç½®
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="æœç´¢" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            é”®å…¥ä»¥å¼€å§‹æœç´¢
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/k8stech/" title="å‰å¾€ Github ä»“åº“" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://docs.prometheus.cool" title="äº‘åŸç”Ÿç›‘æ§ç¥å™¨Prometheus" class="md-nav__button md-logo">
      
        <img src="../../assets/img/prometheus_logo.png" width="48" height="48">
      
    </a>
    äº‘åŸç”Ÿç›‘æ§ç¥å™¨Prometheus
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/k8stech/" title="å‰å¾€ Github ä»“åº“" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="ä»‹ç»" class="md-nav__link">
      ä»‹ç»
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      ç›‘æ§åŸºç¡€ä¸æ¦‚è¿°
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        ç›‘æ§åŸºç¡€ä¸æ¦‚è¿°
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../monitorbasic/whymonitor/" title="ä¸ºä»€ä¹ˆè¦ç›‘æ§" class="md-nav__link">
      ä¸ºä»€ä¹ˆè¦ç›‘æ§
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../monitorbasic/monitorterms/" title="ç›‘æ§æœ¯è¯­" class="md-nav__link">
      ç›‘æ§æœ¯è¯­
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../monitorbasic/metricstory/" title="æŒ‡æ ‡ç‰©è¯­" class="md-nav__link">
      æŒ‡æ ‡ç‰©è¯­
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../monitorbasic/monitorcontrast/" title="å¼€æºç›‘æ§å¯¹æ¯”" class="md-nav__link">
      å¼€æºç›‘æ§å¯¹æ¯”
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Prometheus åŸºç¡€
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Prometheus åŸºç¡€
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../basic/prom-introduction/" title="Prometheusä»‹ç»" class="md-nav__link">
      Prometheusä»‹ç»
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../basic/tsdb-contrast/" title="æ—¶åºæ•°æ®åº“å¯¹æ¯”" class="md-nav__link">
      æ—¶åºæ•°æ®åº“å¯¹æ¯”
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../basic/prom-datamodel/" title="æ•°æ®æ¨¡å‹" class="md-nav__link">
      æ•°æ®æ¨¡å‹
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../basic/node-exporter/" title="Node_Exporter" class="md-nav__link">
      Node_Exporter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../basic/prom-config/" title="Prometheuså®‰è£…ä¸é…ç½®" class="md-nav__link">
      Prometheuså®‰è£…ä¸é…ç½®
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Prometheus è¿›é˜¶
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Prometheus è¿›é˜¶
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced/auto-ops-exporter-1/" title="è‡ªåŠ¨åŒ–ç»´æŠ¤Exporterï¼ˆä¸€ï¼‰" class="md-nav__link">
      è‡ªåŠ¨åŒ–ç»´æŠ¤Exporterï¼ˆä¸€ï¼‰
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced/auto-ops-exporter-2/" title="è‡ªåŠ¨åŒ–ç»´æŠ¤Exporterï¼ˆäºŒï¼‰" class="md-nav__link">
      è‡ªåŠ¨åŒ–ç»´æŠ¤Exporterï¼ˆäºŒï¼‰
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced/docker-swarm-monitor-1/" title="Docker-Swarmé›†ç¾¤ç›‘æ§ï¼ˆä¸€ï¼‰" class="md-nav__link">
      Docker-Swarmé›†ç¾¤ç›‘æ§ï¼ˆä¸€ï¼‰
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced/docker-swarm-monitor-2/" title="Docker-Swarmé›†ç¾¤ç›‘æ§ï¼ˆäºŒï¼‰" class="md-nav__link">
      Docker-Swarmé›†ç¾¤ç›‘æ§ï¼ˆäºŒï¼‰
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced/commonly-exporter/" title="å¸¸ç”¨Exporterä»‹ç»ä¸é…ç½®" class="md-nav__link">
      å¸¸ç”¨Exporterä»‹ç»ä¸é…ç½®
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" checked>
    
    <label class="md-nav__link" for="nav-5">
      Prometheus(è­¦æŠ¥)
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Prometheus(è­¦æŠ¥)
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../promql-basic/" title="PromQLè¯¦è§£ï¼ˆä¸€ï¼‰" class="md-nav__link">
      PromQLè¯¦è§£ï¼ˆä¸€ï¼‰
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../promql-operator/" title="PromQLè¯¦è§£ï¼ˆäºŒï¼‰" class="md-nav__link">
      PromQLè¯¦è§£ï¼ˆäºŒï¼‰
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../promql-operator2/" title="PromQLè¯¦è§£ï¼ˆä¸‰ï¼‰" class="md-nav__link">
      PromQLè¯¦è§£ï¼ˆä¸‰ï¼‰
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../promql-function/" title="PromQLå‡½æ•°" class="md-nav__link">
      PromQLå‡½æ•°
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../alertmanager-overview/" title="AlertManager" class="md-nav__link">
      AlertManager
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../alertmanager-rules-1/" title="Rulesè¯¦è§£ï¼ˆä¸€ï¼‰" class="md-nav__link">
      Rulesè¯¦è§£ï¼ˆä¸€ï¼‰
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../alertmanager-rules-2/" title="Rulesè¯¦è§£ï¼ˆäºŒï¼‰" class="md-nav__link">
      Rulesè¯¦è§£ï¼ˆäºŒï¼‰
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Receiveré…ç½®
      </label>
    
    <a href="./" title="Receiveré…ç½®" class="md-nav__link md-nav__link--active">
      Receiveré…ç½®
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">ç›®å½•</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" title="è­¦æŠ¥é€šçŸ¥æ¥æ”¶å™¨" class="md-nav__link">
    è­¦æŠ¥é€šçŸ¥æ¥æ”¶å™¨
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#email" title="Email" class="md-nav__link">
    Email
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" title="ä¼ä¸šå¾®ä¿¡" class="md-nav__link">
    ä¼ä¸šå¾®ä¿¡
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#webhook" title="é’‰é’‰æœºå™¨äºº(Webhook)" class="md-nav__link">
    é’‰é’‰æœºå™¨äºº(Webhook)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" title="è­¦æŠ¥é€šçŸ¥æ¨¡æ¿" class="md-nav__link">
    è­¦æŠ¥é€šçŸ¥æ¨¡æ¿
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" title="å¼€æºè­¦æŠ¥ç»„ä»¶æ¨è" class="md-nav__link">
    å¼€æºè­¦æŠ¥ç»„ä»¶æ¨è
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../alertmanager-silences/" title="Silencesé…ç½®" class="md-nav__link">
      Silencesé…ç½®
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Prometheus(è”é‚¦é›†ç¾¤)
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Prometheus(è”é‚¦é›†ç¾¤)
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../federation/federation-overview/" title="Prometheus è”é‚¦é›†ç¾¤" class="md-nav__link">
      Prometheus è”é‚¦é›†ç¾¤
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../federation/pushgateway/" title="Pushgateway ä»£ç†" class="md-nav__link">
      Pushgateway ä»£ç†
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../federation/alertmanager-ha/" title="Alertmanager é«˜å¯ç”¨" class="md-nav__link">
      Alertmanager é«˜å¯ç”¨
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Prometheus(æœåŠ¡å‘ç°)
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Prometheus(æœåŠ¡å‘ç°)
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../discover-service/discovery-overview/" title="æœåŠ¡å‘ç°ï¼ˆæ–‡ä»¶ã€DNSï¼‰" class="md-nav__link">
      æœåŠ¡å‘ç°ï¼ˆæ–‡ä»¶ã€DNSï¼‰
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../discover-service/discovery-relabeling/" title="æœåŠ¡å‘ç°ï¼ˆRelabellingï¼‰" class="md-nav__link">
      æœåŠ¡å‘ç°ï¼ˆRelabellingï¼‰
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../discover-service/discovery-consul/" title="æœåŠ¡å‘ç°ï¼ˆConsulï¼‰" class="md-nav__link">
      æœåŠ¡å‘ç°ï¼ˆConsulï¼‰
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Prometheus(Operator)
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        Prometheus(Operator)
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Kubernetes/Prometheus-Operator/" title="Operatoræ¦‚è¿°" class="md-nav__link">
      Operatoræ¦‚è¿°
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Kubernetes/Prometheus-Statefulsets-1/" title="æ‰‹åŠ¨éƒ¨ç½²ï¼ˆ1ï¼‰" class="md-nav__link">
      æ‰‹åŠ¨éƒ¨ç½²ï¼ˆ1ï¼‰
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Kubernetes/Prometheus-Statefulsets-2/" title="æ‰‹åŠ¨éƒ¨ç½²ï¼ˆ2ï¼‰" class="md-nav__link">
      æ‰‹åŠ¨éƒ¨ç½²ï¼ˆ2ï¼‰
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Kubernetes/Prometheus-Statefulsets-3/" title="æ‰‹åŠ¨éƒ¨ç½²ï¼ˆè”é‚¦ï¼‰" class="md-nav__link">
      æ‰‹åŠ¨éƒ¨ç½²ï¼ˆè”é‚¦ï¼‰
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">ç›®å½•</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" title="è­¦æŠ¥é€šçŸ¥æ¥æ”¶å™¨" class="md-nav__link">
    è­¦æŠ¥é€šçŸ¥æ¥æ”¶å™¨
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#email" title="Email" class="md-nav__link">
    Email
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" title="ä¼ä¸šå¾®ä¿¡" class="md-nav__link">
    ä¼ä¸šå¾®ä¿¡
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#webhook" title="é’‰é’‰æœºå™¨äºº(Webhook)" class="md-nav__link">
    é’‰é’‰æœºå™¨äºº(Webhook)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" title="è­¦æŠ¥é€šçŸ¥æ¨¡æ¿" class="md-nav__link">
    è­¦æŠ¥é€šçŸ¥æ¨¡æ¿
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" title="å¼€æºè­¦æŠ¥ç»„ä»¶æ¨è" class="md-nav__link">
    å¼€æºè­¦æŠ¥ç»„ä»¶æ¨è
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/k8stech/edit/master/docs/Alertmanager/alertmanager-receiver.md" title="ç¼–è¾‘æ­¤é¡µ" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>Receiveré…ç½®</h1>
                
                <blockquote>
<p>æœ¬ç« ä¸»è¦å¯¹å¦‚ä½•ä½¿ç”¨å¼€æºç»„ä»¶å’ŒAlertmanagerç»„ä»¶é›†æˆè­¦æŠ¥é€šçŸ¥ã€‚Kubernetesçš„è­¦æŠ¥é›†æˆåç»­ä¼šç›´æ¥åœ¨é…ç½®æ–‡ä»¶è®²è§£ï¼ŒåŸç†å¤§åŒå°å¼‚ï¼Œæ­¤å¤„ä»…å¯¹ç›¸å…³è­¦æŠ¥é€šçŸ¥åšé›†æˆã€‚
</p>
</blockquote>
<h3 id="_1">è­¦æŠ¥é€šçŸ¥æ¥æ”¶å™¨<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h3>
<p>å‰é¢ä¸€ç›´æ˜¯åœ¨Web UI æŸ¥çœ‹è­¦æŠ¥ä¿¡æ¯ï¼Œç°åœ¨å¼€å§‹ä½¿ç”¨æ¥æ”¶å™¨ä¸ALertmanageré›†æˆï¼Œå‘é€è­¦æŠ¥ä¿¡æ¯åˆ° <code>Email</code>ã€<code>ä¼ä¸šå¾®ä¿¡</code>ã€<code>é’‰é’‰æœºå™¨äºº</code>ï¼Œå¯¹äºè­¦æŠ¥è¦æ±‚æ¯”è¾ƒé«˜çš„åŒå­¦ï¼Œå¯ä»¥æ ¹æ®ä¸‹é¢æåˆ°çš„å¼€æºç»„ä»¶ ã€PrometheusAlertå…¨å®¶æ¡¶ã€‘ é…ç½®é£ä¹¦ã€çŸ­ä¿¡ã€è¯­éŸ³ç”µè¯ç­‰è­¦æŠ¥ã€‚</p>
<h4 id="email">Email<a class="headerlink" href="#email" title="Permanent link">&para;</a></h4>
<p>å‰é¢å·²ç»è®²è¿‡ï¼ŒALertmanageré»˜è®¤æ”¯æŒé…ç½®Emailï¼Œä¹Ÿæ˜¯æœ€æ™®é€šçš„æ–¹å¼ï¼Œåœ¨ALertmanagerç»„ä»¶ä¸­å†…ç½®äº†SMTPåè®®ã€‚ç›´æ¥å¯ä»¥æŠŠå‰é¢çš„Alertmanager.ymlä¸­çš„SMTPéƒ¨åˆ†æˆªå–å‡ºæ¥ï¼Œç„¶åè¿›è¡Œè°ƒæ•´ä¸é…ç½®</p>
<pre class="highlight"><code class="language-yaml">global:
  resolve_timeout: 5m
  # smtpé…ç½®
  smtp_from: "user@163.com" # å‘é€é‚®ä»¶ä¸»é¢˜
  smtp_smarthost: 'smtp.163.com:25' # é‚®ç®±æœåŠ¡å™¨çš„SMTPä¸»æœºé…ç½®
  smtp_auth_username: "user@163.com" # ç™»å½•ç”¨æˆ·å
  smtp_auth_password: "pass" # æ­¤å¤„çš„auth passwordæ˜¯é‚®ç®±çš„ç¬¬ä¸‰æ–¹ç™»å½•æˆæƒå¯†ç ï¼Œè€Œéç”¨æˆ·å¯†ç ã€‚
  smtp_require_tls: false # æœ‰äº›é‚®ç®±éœ€è¦å¼€å¯æ­¤é…ç½®ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯163é‚®ç®±ï¼Œä»…åšæµ‹è¯•ï¼Œä¸éœ€è¦å¼€å¯æ­¤åŠŸèƒ½ã€‚
route:
  receiver: ops
  group_wait: 30s # åœ¨ç»„å†…ç­‰å¾…æ‰€é…ç½®çš„æ—¶é—´ï¼Œå¦‚æœåŒç»„å†…ï¼Œ30ç§’å†…å‡ºç°ç›¸åŒæŠ¥è­¦ï¼Œåœ¨ä¸€ä¸ªç»„å†…å‡ºç°ã€‚
  group_interval: 5m # å¦‚æœç»„å†…å†…å®¹ä¸å˜åŒ–ï¼Œåˆå¹¶ä¸ºä¸€æ¡è­¦æŠ¥ä¿¡æ¯ï¼Œ5måå‘é€ã€‚
  repeat_interval: 24h # å‘é€æŠ¥è­¦é—´éš”ï¼Œå¦‚æœæŒ‡å®šæ—¶é—´å†…æ²¡æœ‰ä¿®å¤ï¼Œåˆ™é‡æ–°å‘é€æŠ¥è­¦ã€‚
  group_by: [alertname]  # æŠ¥è­¦åˆ†ç»„
  routes:
      - match:
          team: operations
        group_by: [env,dc]
        receiver: 'ops'
      - receiver: ops # è·¯ç”±å’Œæ ‡ç­¾ï¼Œæ ¹æ®matchæ¥æŒ‡å®šå‘é€ç›®æ ‡ï¼Œå¦‚æœ ruleçš„lable åŒ…å« alertnameï¼Œ ä½¿ç”¨ ops æ¥å‘é€
        group_wait: 10s
        match:
          team: operations
# æ¥æ”¶å™¨æŒ‡å®šå‘é€äººä»¥åŠå‘é€æ¸ é“
receivers:
# opsåˆ†ç»„çš„å®šä¹‰
- name: ops
  email_configs:
  - to: '9935226@qq.com,xxxxx@qq.com' # å¦‚æœæƒ³å‘é€å¤šä¸ªäººå°±ä»¥ ','åšåˆ†å‰²ï¼Œå†™å¤šä¸ªé‚®ä»¶äººå³å¯ã€‚
    send_resolved: true
    headers:
      from: "è­¦æŠ¥ä¸­å¿ƒ"
      subject: "[operations] æŠ¥è­¦é‚®ä»¶"
      to: "å°ç…œç‹¼çš‡"</code></pre>

<p>é…ç½®å®Œæˆåï¼Œç›´æ¥é‡å¯Alertmanagerç»„ä»¶ï¼Œä½¿é…ç½®ç”Ÿæ•ˆï¼Œç„¶åä½¿ç”¨å‰é¢å†…å­˜é˜ˆå€¼è§¦å‘ä¸€æ¬¡è­¦æŠ¥æ¥çœ‹ä¸‹å‘é€ç»“æœã€‚</p>
<p>æ”¶åˆ°çš„è­¦æŠ¥ä¿¡æ¯ï¼š</p>
<p><img alt="email-info" src="https://images.k8stech.net/email-info.png" /></p>
<p>å½“è­¦æŠ¥æ¥è§¦ä»¥åæ”¶åˆ°çš„æ¢å¤ä¿¡æ¯ã€‚</p>
<p><img alt="email-info" src="https://images.k8stech.net/email-resolve.png" /></p>
<h4 id="_2">ä¼ä¸šå¾®ä¿¡<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h4>
<p>é¦–å…ˆä½ è¦å…·æœ‰ä¼ä¸šå¾®ä¿¡ç®¡ç†å‘˜çš„æƒé™ï¼Œå¦‚æœæ²¡æœ‰å¯ä»¥è‡ªå·±æ³¨å†Œä¸€ä¸ªï¼Œè¿›è¡Œæµ‹è¯•ï¼Œæˆ‘è¿™é‡Œæœ‰è‡ªè¡Œæ³¨å†Œçš„ä¼ä¸šå¾®ä¿¡</p>
<p>ç¬¬ä¸€æ­¥ç™»å½•è¿›å…¥ä»¥åï¼Œåœ¨åº”ç”¨ç®¡ç†ä¸­æ–°å»ºåº”ç”¨ã€‚</p>
<p><img alt="email-info" src="https://images.k8stech.net/wechat-app.png" /></p>
<p>ç¬¬äºŒæ­¥ï¼Œåˆ›å»ºåº”ç”¨ï¼Œä¿¡æ¯å¡«å†™å¦‚ä¸‹ï¼Œä¸Šä¼ åº”ç”¨logoéšæ„ã€‚</p>
<p><img alt="email-info" src="https://images.k8stech.net/wechat-app-info.png" /></p>
<p>åˆ›å»ºæˆåŠŸä»¥åå¦‚ä¸‹å›¾ã€‚</p>
<p><img alt="wechat-app-info" src="https://images.k8stech.net/youdian-wehchat-info.png" /></p>
<p>è¿™æ—¶å€™éœ€è¦æŠŠ <code>AgentId</code> å’Œ <code>Secret</code> è®°å½•ä¸‹æ¥ï¼Œå¯¹äºä½ çš„è¿™ç§Secretä¿¡æ¯ï¼Œæœ€å¥½ç®¡ç†å¥½ï¼Œæˆ‘çš„ç”¨è¿‡å°±ä¼šåˆ é™¤ï¼Œæ‰€ä»¥ä¸ç”¨æ‹…å¿ƒå®‰å…¨éšæ‚£ã€‚</p>
<table>
<thead>
<tr>
<th align="center">ID</th>
<th align="center">key</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><code>AgentId</code></td>
<td align="center"><code>1000004</code></td>
</tr>
<tr>
<td align="center"><code>Secret</code></td>
<td align="center"><code>F-fzpgsabmfiFt7_4QRQwWEl8eyx7evO12sRYe_Q5vA</code></td>
</tr>
</tbody>
</table>
<p>ç¬¬ä¸‰æ­¥ï¼Œç°åœ¨æˆ‘ä»¬æ¥ç”¨æ–°å»ºçš„ä¼ä¸šå¾®ä¿¡åº”ç”¨åœ¨Alertmanageré…ç½®ï¼Œå¯ä»¥é…ç½®å…¨å±€ï¼Œä¹Ÿå¯ä»¥å¯¹å•ç‹¬éœ€è¦å‘é€çš„æ¥æ”¶å™¨ï¼Œå› ä¸ºè­¦æŠ¥éœ€è¦åˆ†çº§ï¼Œæ‰€ä»¥éœ€è¦å•ç‹¬å¤„ç†ï¼Œåœ¨è¿™é‡Œä½¿ç”¨çš„çš„å•ç‹¬çš„é…ç½®ï¼Œéœ€è¦çŸ¥é“ <strong>ä¼ä¸šID</strong> ï¼Œä»¥åŠ <strong>éƒ¨é—¨ID</strong> ã€‚</p>
<p><strong>ä¼ä¸šID</strong> é€šè¿‡</p>
<p><img alt="bs-id" src="https://images.k8stech.net/wechat-bs-id.png" /></p>
<p><strong>éƒ¨é—¨ID</strong> é€šè¿‡é€šè®¯å½•è·å–</p>
<p><img alt="bs-id" src="https://images.k8stech.net/wechat-branch-id.png" /></p>
<pre class="highlight"><code class="language-yaml"># ä¼ä¸šå¾®ä¿¡é…ç½®
  wechat_configs:
  - corp_id: 'wwxxxxx' # ä¼ä¸šIDæ˜¯å”¯ä¸€æ ‡è¯†
    api_url: 'https://qyapi.weixin.qq.com/cgi-bin/' # ä¼ä¸šå¾®ä¿¡apiæ¥å£ï¼Œç»Ÿä¸€å®šä¹‰
    send_resolved: true # è®¾ç½®å‘é€è­¦æŠ¥æ¢å¤ä¿¡æ¯
    to_party: '2' # éƒ¨é—¨idï¼Œæ¯”å¦‚æˆ‘çš„å«è­¦æŠ¥ç»„ï¼Œå› æ­¤æ˜¾ç¤ºçš„æ˜¯2ï¼Œå¦‚æœä½ DBç»„ï¼Œå°±å¯èƒ½ä¼šæ˜¯3ï¼ŒWEBç»„å°±æ˜¯4ï¼Œä¾æ¬¡ç±»æ¨ï¼Œå¦å¤–éœ€è¦æ¥æ”¶è­¦æŠ¥çš„ç›¸å…³äººå‘˜å¿…é¡»åœ¨è¿™ä¸ªéƒ¨é—¨é‡Œã€‚
    agent_id: '1000004' # æ–°å»ºåº”ç”¨çš„agent_id
    api_secret: 'F-fzpgsabmfiFt7_4QRQwWEl8eyx7evO12sRYe_Q5vA' # æ–°å»ºåº”ç”¨çš„Secret</code></pre>

<p>è¿™æ—¶å€™æˆ‘ä»¬é‡å¯Alertmanagerï¼Œç„¶åä½¿ç”¨ä¹‹å‰çš„æ–¹å¼æ¥è§¦å‘æ¨¡æ‹Ÿè­¦æŠ¥ï¼Œçœ‹çœ‹å‘é€æ˜¯ä¸æ˜¯å·²ç»æ²¡æœ‰é—®é¢˜äº†ï¼Œè¿™æ—¶æˆ‘ä»¬çš„ä¼ä¸šå¾®ä¿¡ä¸­ã€Emailéƒ½å¯ä»¥æ”¶åˆ°è­¦æŠ¥äº†ï¼Œè¿™é‡Œçš„è­¦æŠ¥å·²ç»è¢«æˆ‘ç”¨æ¨¡å—å¤„ç†è¿‡äº†ã€‚å¯è¯»æ€§ä¼šæ›´é«˜ã€‚</p>
<pre class="highlight"><code class="language-yaml">cat wechat.tmpl
## wechatæ¨¡æ¿
{{ define "wechat.default.message" }}
{{ if gt (len .Alerts.Firing) 0 -}}
Alerts Firing:
{{ range .Alerts }}
è­¦æŠ¥çº§åˆ«ï¼š{{ .Labels.status }}

è­¦æŠ¥ç±»å‹ï¼š{{ .Labels.alertname }}

æ•…éšœä¸»æœº: {{ .Labels.instance }}

è­¦æŠ¥ä¸»é¢˜: {{ .Annotations.summary }}

è­¦æŠ¥è¯¦æƒ…: {{ .Annotations.description }}

â± : {{ (.StartsAt.Add 28800e9).Format "2006-01-02 15:04:05" }}
{{- end }}
{{- end }}

{{ if gt (len .Alerts.Resolved) 0 -}}
Alerts Resolved:
{{ range .Alerts }}
è­¦æŠ¥çº§åˆ«ï¼š{{ .Labels.status }}

è­¦æŠ¥ç±»å‹ï¼š{{ .Labels.alertname }}

æ•…éšœä¸»æœº: {{ .Labels.instance }}

è­¦æŠ¥ä¸»é¢˜: {{ .Annotations.summary }}

è­¦æŠ¥è¯¦æƒ…: {{ .Annotations.description }}

â± : {{ (.StartsAt.Add 28800e9).Format "2006-01-02 15:04:05" }}
â² : {{ (.EndsAt.Add 28800e9).Format "2006-01-02 15:04:05" }}
{{- end }}
{{- end }}
{{- end }}</code></pre>

<p>Firingè­¦æŠ¥ï¼š</p>
<p><img alt="wechat-alert" src="https://images.k8stech.net/wechat-alert.jpeg" /></p>
<p>ä¸‹é¢æ˜¯Resolveçš„è­¦æŠ¥ï¼š</p>
<p><img alt="wechat-alert" src="https://images.k8stech.net/wecaht-alert-resolve.jpeg" /></p>
<h4 id="webhook">é’‰é’‰æœºå™¨äºº(Webhook)<a class="headerlink" href="#webhook" title="Permanent link">&para;</a></h4>
<p>å¯¹äºé’‰é’‰å¤§å®¶éƒ½å·²ç»å¾ˆç†Ÿæ‚‰äº†ï¼Œå¤§éƒ¨åˆ†ä¼ä¸šéƒ½å·²ç»å¯ç”¨é’‰é’‰åŠå…¬äº†ï¼ŒåŒæ—¶å…¶æ¨å‡ºçš„å…è´¹çš„webhookæœºå™¨äººä¹Ÿå¾ˆå—å¤§å®¶çš„æ¬¢è¿ã€‚æˆ‘ä»¬è¿™é‡Œè®²ä¸€ä¸‹å€ŸåŠ©ç¬¬ä¸‰æ–¹å¼€æºç»„ä»¶å¦‚ä½•å¯¹é’‰é’‰é›†æˆè­¦æŠ¥åŠŸèƒ½ã€‚</p>
<p>é¦–å…ˆéœ€è¦åœ¨é’‰é’‰åˆ›å»ºæœºå™¨äººï¼Œç„¶ååœ¨ç™½åå•ä¸­æ·»åŠ å…³é”®å­—ä¿¡æ¯ä¸ipé™åˆ¶ç­‰å®‰å…¨è®¾ç½®ï¼Œè¿™ä¸ªåªè¦ä½ æœ‰ç¾¤ï¼Œä½ å°±å¯ä»¥åœ¨ç¾¤é‡Œé¢å»ºï¼Œéå¸¸ç®€å•ï¼Œè¿™é‡Œå°±ä¸åšæ¼”ç¤ºäº†</p>
<p>å…ˆæŠŠPrometheus-webhook-Dingtalkç»„ä»¶è£…å¥½ã€‚</p>
<pre class="highlight"><code class="language-bash">mkdir -p /etc/prometheus-webhook-dingtalk/template/
cd /etc/prometheus-webhook-dingtalk/
wget https://github.com/timonwong/prometheus-webhook-dingtalk/releases/download/v1.4.0/prometheus-webhook-dingtalk-1.4.0.linux-amd64.tar.gz
tar xf prometheus-webhook-dingtalk-1.4.0.linux-amd64.tar.gz
mv prometheus-webhook-dingtalk-1.4.0.linux-amd64/* /etc/prometheus-webhook-dingtalk/
mv prometheus-webhook-dingtalk /bin/
cat &lt;&lt;EOF&gt; /lib/systemd/system/prometheus-webhook-dingtalk.service 
[Unit]
Description=prometheus-webhook-dingding
Documentation=https://prometheus.io/
After=network.target

[Service]
Type=simple
User=prometheus
ExecStart=/bin/prometheus-webhook-dingtalk --web.listen-address=":8070" --web.enable-ui --config.file="/etc/prometheus-webhook-dingtalk/config.yml"
Restart=on-failure

[Install]
WantedBy=multi-user.target
EOF
## å¯åŠ¨æœåŠ¡
systemctl enable prometheus-webhook-dingtalk.service
systemctl start prometheus-webhook-dingtalk.service</code></pre>

<p>é…ç½®æ–‡ä»¶
<pre class="highlight"><code class="language-yaml">## Request timeout
# timeout: 5s

## Customizable templates path
## Customizable templates path
templates:
        # - contrib/templates/legacy/template.tmpl
  # è‡ªå®šä¹‰æ¨¡æ¿è·¯å¾„
  - /etc/prometheus-webhook-dingtalk/template/default.tmpl

## ä½ è¿˜å¯ä»¥ä½¿ç”¨' default_message 'è¦†ç›–é»˜è®¤æ¨¡æ¿
## ä¸‹é¢çš„ç¤ºä¾‹ä½¿ç”¨v0.3.0ä¸­çš„â€œlegacyâ€æ¨¡æ¿
# default_message:
#   title: '{{ template "legacy.title" . }}'
#   text: '{{ template "legacy.content" . }}'

## Targets, previously was known as "profiles"
# å®šä¹‰çš„webhookï¼Œé’‰é’‰åˆ›å»ºçš„webhook token
targets:
# å¦‚æœæœ‰å¤šä¸ªåˆ†ç»„å°±å¯ä»¥åœ¨è¿™é‡Œå®šä¹‰å¤šä¸ªæ¥å£
  ops:
    url: https://oapi.dingtalk.com/robot/send?access_token=a4feed2322222222222222222222222
  web:
    url: https://oapi.dingtalk.com/robot/send?access_token=a4feed2325c1333333333333333333333</code></pre></p>
<p>å®šä¹‰æ¨¡æ¿ï¼š</p>
<pre class="highlight"><code class="language-bash">cd /etc/prometheus-webhook-dingtalk/template
cat default.tmpl
{{ define "__subject" }}[{{ .Status | toUpper }}{{ if eq .Status "firing" }}:{{ .Alerts.Firing | len }}{{ end }}] {{ .GroupLabels.SortedPairs.Values | join " " }} {{ if gt (len .CommonLabels) (len .GroupLabels) }}({{ with .CommonLabels.Remove .GroupLabels.Names }}{{ .Values | join " " }}{{ end }}){{ end }}{{ end }}
{{ define "__alertmanagerURL" }}{{ .ExternalURL }}/#/alerts?receiver={{ .Receiver }}{{ end }}

{{ define "__text_alert_list" }}{{ range . }}
**Labels**
{{ range .Labels.SortedPairs }}&gt; - {{ .Name }}: {{ .Value | markdown | html }}
{{ end }}
**Annotations**
{{ range .Annotations.SortedPairs }}&gt; - {{ .Name }}: {{ .Value | markdown | html }}
{{ end }}
**Source:** [{{ .GeneratorURL }}]({{ .GeneratorURL }})
{{ end }}{{ end }}

{{/* Firing */}}

{{ define "default.__text_alert_list" }}{{ range . }}

**Trigger Time:** {{ dateInZone "2006.01.02 15:04:05" (.StartsAt) "Asia/Shanghai" }}

**Summary:** {{ .Annotations.summary }}

**Description:** {{ .Annotations.description }}

**Graph:** [ğŸ“ˆ ]({{ .GeneratorURL }})

**Details:**
{{ range .Labels.SortedPairs }}{{ if and (ne (.Name) "severity") (ne (.Name) "summary") }}&gt; - {{ .Name }}: {{ .Value | markdown | html }}
{{ end }}{{ end }}
{{ end }}{{ end }}

{{/* Resolved */}}

{{ define "default.__text_resolved_list" }}{{ range . }}

**Trigger Time:** {{ dateInZone "2006.01.02 15:04:05" (.StartsAt) "Asia/Shanghai" }}

**Resolved Time:** {{ dateInZone "2006.01.02 15:04:05" (.EndsAt) "Asia/Shanghai" }}

**Summary:** {{ .Annotations.summary }}

**Graph:** [ğŸ“ˆ ]({{ .GeneratorURL }})

**Details:**
{{ range .Labels.SortedPairs }}{{ if and (ne (.Name) "severity") (ne (.Name) "summary") }}&gt; - {{ .Name }}: {{ .Value | markdown | html }}
{{ end }}{{ end }}
{{ end }}{{ end }}

{{/* Default */}}
{{ define "default.title" }}{{ template "__subject" . }}{{ end }}
{{ define "default.content" }}#### \[{{ .Status | toUpper }}{{ if eq .Status "firing" }}:{{ .Alerts.Firing | len }}{{ end }}\] **[{{ index .GroupLabels "alertname" }}]({{ template "__alertmanagerURL" . }})**
{{ if gt (len .Alerts.Firing) 0 -}}

![Firing-img](https://is3-ssl.mzstatic.com/image/thumb/Purple20/v4/e0/23/cf/e023cf56-0623-0cdf-afce-97ae90eabfda/mzl.uplmrpgi.png/320x0w.jpg)

**Alerts Firing**
{{ template "default.__text_alert_list" .Alerts.Firing }}
{{- end }}
{{ if gt (len .Alerts.Resolved) 0 -}}

![Resolved-img](https://is3-ssl.mzstatic.com/image/thumb/Purple18/v4/41/72/99/4172990a-f666-badf-9726-6204a320c16e/mzl.dypdixoy.png/320x0w.png)

**Alerts Resolved**
{{ template "default.__text_resolved_list" .Alerts.Resolved }}
{{- end }}
{{- end }}

{{/* Legacy */}}
{{ define "legacy.title" }}{{ template "__subject" . }}{{ end }}
{{ define "legacy.content" }}#### \[{{ .Status | toUpper }}{{ if eq .Status "firing" }}:{{ .Alerts.Firing | len }}{{ end }}\] **[{{ index .GroupLabels "alertname" }}]({{ template "__alertmanagerURL" . }})**
{{ template "__text_alert_list" .Alerts.Firing }}
{{- end }}

{{/* Following names for compatibility */}}
{{ define "ding.link.title" }}{{ template "default.title" . }}{{ end }}
{{ define "ding.link.content" }}{{ template "default.content" . }}{{ end }}</code></pre>

<p>åœ¨ALertmanagerä¸­é…ç½®è­¦æŠ¥</p>
<pre class="highlight"><code class="language-yaml"># æ¥æ”¶å™¨æŒ‡å®šå‘é€äººä»¥åŠå‘é€æ¸ é“
receivers:
# opsåˆ†ç»„çš„å®šä¹‰
- name: ops
  email_configs:
  - to: '9935226@qq.com,10000@qq.com'
    send_resolved: true
    headers: { Subject: "[operations] æŠ¥è­¦é‚®ä»¶"} # æ¥æ”¶é‚®ä»¶çš„æ ‡é¢˜
  # é’‰é’‰é…ç½®
  webhook_configs:
  - url: http://localhost:8070/dingtalk/ops/send # è¿™é‡Œæ˜¯åœ¨é’‰é’‰å¼€æºç»„ä»¶ä¸­çš„æ¥å£ï¼Œå¦‚æœå•ç‹¬å®šä¹‰çš„receiveréœ€è¦å¯¹åº”ä½ çš„åˆ†ç»„ä¸é’‰é’‰æœºå™¨äººçš„webhook token
    # ä¼ä¸šå¾®ä¿¡é…ç½®
  wechat_configs:
  - corp_id: 'ww5421dksajhdasjkhj'
    api_url: 'https://qyapi.weixin.qq.com/cgi-bin/'
    send_resolved: true
    to_party: '2'
    agent_id: '1000002'
    api_secret: 'Tm1kkEE3RGqVhv5hO-khdakjsdkjsahjkdksahjkdsahkj'
# web
- name: web
  email_configs:
  - to: '9935226@qq.com'
    send_resolved: true
    headers: { Subject: "[web] æŠ¥è­¦é‚®ä»¶"} # æ¥æ”¶é‚®ä»¶çš„æ ‡é¢˜
  webhook_configs:
  - url: http://localhost:8070/dingtalk/web/send</code></pre>

<p>ç»§ç»­ä½¿ç”¨ä¸Šé¢çš„è§¦å‘æ¨¡æ‹Ÿè­¦æŠ¥ï¼Œæ­¤æ—¶ä¼šåŒæ—¶è®©ä¸‰ä¸ªè­¦æŠ¥éƒ½æ¥å—åˆ°è­¦æŠ¥ä¿¡æ¯ï¼Œæˆ‘ä»¬è¿™é‡Œåªæ˜¯ä¸ºäº†è°ƒè¯•ï¼Œå¾€å¾€ä¸€ä¸ªè­¦æŠ¥é€šçŸ¥å°±å¯ä»¥æ»¡è¶³éœ€æ±‚äº†ï¼Œå¯¹äºé‡è¦ä¸šåŠ¡è¿˜æ˜¯éœ€è¦ä½¿ç”¨ç”µè¯ä»¥åŠçŸ­ä¿¡æé†’ã€‚</p>
<p>é’‰é’‰Firingè­¦æŠ¥ï¼š</p>
<p><img alt="dingtail-1" src="https://images.k8stech.net/dingtalk-firing.png" /></p>
<p>é’‰é’‰Resolveè­¦æŠ¥ï¼š</p>
<p><img alt="dingtail-2" src="https://images.k8stech.net/dingtalk-resolve.png" /></p>
<h3 id="_3">è­¦æŠ¥é€šçŸ¥æ¨¡æ¿<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<p>Prometheus åˆ›å»ºè­¦æŠ¥è½¬å‘ç»™ Alertmanagerï¼ŒAlertmanagerä¼šæ ¹æ®ä¸åŒçš„ Label å‘ä¸åŒçš„ Receiver å‘é€è­¦æŠ¥é€šçŸ¥ï¼Œå¦‚Emailã€é’‰é’‰ã€ä¼ä¸šå¾®ä¿¡ã€é£ä¹¦ã€çŸ­ä¿¡ç­‰ç­‰ã€‚æ‰€æœ‰ Receiveréƒ½ä¸€ä¸ªæ¥æ”¶æ¨¡æ¿ï¼Œç„¶åé€šè¿‡æ¨¡æ¿æ ¼å¼åŒ–ä»¥åå‘é€è­¦æŠ¥ä¿¡æ¯ç»™ Receiverã€‚
Alertmanager è‡ªå¸¦çš„æ¨¡æ¿æ˜¯åŸºäº Go è¯­è¨€çš„ template æ¨¡æ¿ï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚å»å®šä¹‰è‡ªå·±éœ€è¦çš„æ¨¡æ¿ï¼Œä¸Šé¢æˆ‘ç»™å‡ºçš„æ¨¡æ¿å·²ç»è¶³å¤Ÿå¤§å®¶çš„åŸºç¡€ä½¿ç”¨äº†ã€‚</p>
<p>ä¸‹é¢ä»‹ç»ä¸‹é€šå¸¸è‡ªå®šä¹‰æ¨¡æ¿ä¸­ä¼šéœ€è¦ç”¨åˆ°çš„ä¸€äº›å‚æ•°è¯´æ˜</p>
<table>
<thead>
<tr>
<th align="center">åç§°</th>
<th align="center">æ•°æ®ç±»å‹</th>
<th align="center">æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><code>Receiver</code></td>
<td align="center">string</td>
<td align="center">æ¥å—è­¦æŠ¥é€šçŸ¥çš„æ¥æ”¶å™¨åç§°</td>
</tr>
<tr>
<td align="center"><code>Status</code></td>
<td align="center">string</td>
<td align="center">è­¦æŠ¥çŠ¶æ€ï¼Œä¾‹å¦‚ï¼šFiringæˆ–Resolvedçš„é€šçŸ¥</td>
</tr>
<tr>
<td align="center"><code>Alert</code></td>
<td align="center">Alert</td>
<td align="center">è­¦æŠ¥é€šçŸ¥çš„çœŸå®å†…å®¹ï¼Œè­¦æŠ¥ä¸­çš„æ‰€æœ‰åˆ—è¡¨</td>
</tr>
<tr>
<td align="center"><code>GroupLables</code></td>
<td align="center">KV</td>
<td align="center">åŒ…å«è­¦æŠ¥é€šçŸ¥çš„ç»„æ ‡ç­¾</td>
</tr>
<tr>
<td align="center"><code>CommandLabels</code></td>
<td align="center">KV</td>
<td align="center">æ‰€æœ‰è­¦æŠ¥çš„å…¬å…±æ ‡ç­¾ï¼ŒåŒ…å«GroupLabelsçš„æ‰€æœ‰æ ‡ç­¾</td>
</tr>
<tr>
<td align="center"><code>CommandAnnotations</code></td>
<td align="center">KV</td>
<td align="center">æ³¨é‡Šï¼Œæ¯”å¦‚è‡ªå®šä¹‰çš„ä¸€äº›å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center"><code>ExternalURL</code></td>
<td align="center">string</td>
<td align="center">è­¦æŠ¥ä¿¡æ¯ä¸­çš„Alertmanageråœ°å€</td>
</tr>
</tbody>
</table>
<p>ä¸Šé¢è¯´çš„KVç±»å‹æ˜¯ä¸€ç»„ä½¿ç”¨ä¸æ ‡ç¤ºæ ‡ç­¾ä¸æ³¨é‡Šçš„Key/Valueå­—ç¬¦ä¸²å¯¹ï¼Œå¯ä»¥åœ¨Alertmanagerä¸­çš„é»˜è®¤æ¨¡æ¿ä¸­çœ‹åˆ°å…¶å®šä¹‰ã€‚ <a href="https://github.com/prometheus/alertmanager/blob/master/template/default.tmpl">default.tmpl</a></p>
<p>å…¶ä¸­é‚®ä»¶ä¸­æ‰€æ˜¾ç¤ºçš„ <code>View In AlertManager</code> ï¼ŒReceiver ä¸ ExternalURLçš„å®šä¹‰å…¶å®å°±æ˜¯æ¨¡æ¿ä¸­çš„ <strong>.ExternalURL</strong> ä¸ <strong>.Receiver</strong> ã€‚ </p>
<pre class="highlight"><code class="language-yaml">{{ define "__alertmanager" }}AlertManager{{ end }}

{{ define "__alertmanagerURL" }}{{ .ExternalURL }}/#/alerts?receiver={{ .Receiver | urlquery }}{{ end }}
...</code></pre>

<p>åœ¨æ”¶åˆ°çš„é‚®ç®±è­¦æŠ¥ä¸­å¯ä»¥çœ‹åˆ° <code>View In AlertManager</code> çš„é“¾æ¥åœ°å€æ˜¯ï¼š<code>http://192.168.1.220:19093/#/alerts?receiver=ops</code> ã€‚</p>
<p>å¯¹äºAlertçš„ç±»å‹ï¼Œè­¦æŠ¥åˆ—è¡¨çš„å­—æ®µè¿˜åŒ…å«äº†å¦‚ä¸‹å‚æ•°ä¸å®šä¹‰ã€æè¿°</p>
<table>
<thead>
<tr>
<th align="center">åç§°</th>
<th align="center">æ•°æ®ç±»å‹</th>
<th align="center">æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><code>Status</code></td>
<td align="center">string</td>
<td align="center">å®šä¹‰è­¦æŠ¥çŠ¶æ€æ˜¯å·²ç»è§£å†³æˆ–å¤„äºè§¦å‘çŠ¶æ€</td>
</tr>
<tr>
<td align="center"><code>Label</code></td>
<td align="center">KV</td>
<td align="center">åŒ…å«è­¦æŠ¥ä¸­çš„æ ‡ç­¾</td>
</tr>
<tr>
<td align="center"><code>Annotations</code></td>
<td align="center">KV</td>
<td align="center">è­¦æŠ¥çš„ä¸€ç»„æ³¨é‡Š</td>
</tr>
<tr>
<td align="center"><code>StartsAt</code></td>
<td align="center">time.Time</td>
<td align="center">è­¦æŠ¥è§¦å‘æ—¶é—´</td>
</tr>
<tr>
<td align="center"><code>EndsAt</code></td>
<td align="center">time.Time</td>
<td align="center">è­¦æŠ¥ç»“æŸæ—¶é—´ï¼Œåªåœ¨è­¦æŠ¥ç»“æŸçš„æ—¶é—´æ—¶è®¾ç½®</td>
</tr>
<tr>
<td align="center"><code>GeneratorURL</code></td>
<td align="center">string</td>
<td align="center">è­¦æŠ¥è§„åˆ™çš„è¿æ¥URLï¼Œä¹Ÿå°±æ˜¯Prometheusä¸­çš„RulesæŸ¥è¯¢åœ°å€</td>
</tr>
</tbody>
</table>
<p>å¯¹äºè­¦æŠ¥ä¸­çš„é€šçŸ¥æ¨¡æ¿é¦–å…ˆè¦ç†Ÿæ‚‰goè¯­è¨€çš„templateè¯­æ³•ä»¥åŠHTMLç®€å•çš„åŸºç¡€çŸ¥è¯†ï¼Œç„¶åæŠŠä¸Šé¢ç›¸å…³çš„å…ƒæ•°æ®çš„ä¸€äº›ä¿¡æ¯äº†è§£æ¸…æ¥šï¼Œå°±å¯ä»¥è‡ªå·±è°ƒæ•´æ¨¡æ¿äº†ï¼Œå¦‚æœä½ å®åœ¨æ‡’çš„æ”¹ï¼Œæˆ‘è°ƒæ•´å¥½çš„æ¨¡æ¿å¯ä»¥ç›´æ¥æ‹¿å»ç”¨ï¼ŒæŠŠå¯¹åº”çš„æŒ‡æ ‡ã€æ ‡ç­¾åå­—æ”¹ä¸€ä¸‹å°±å¯ä»¥ç”¨äº†ã€‚</p>
<p>ä»¥ä¸‹æ˜¯æˆ‘è‡ªå·±ä¿®æ”¹äº†ä¸€ä¸‹çš„æ¨¡æ¿è­¦æŠ¥æ ¼å¼ï¼Œå¤§å®¶å¯ä»¥çœ‹çœ‹ï¼Œè¿™ä¸ªæ˜¯é€šè¿‡å®˜æ–¹çš„ <a href="https://github.com/prometheus/alertmanager/blob/master/template/default.tmpl">default.tmpl</a> ä¿®æ”¹çš„ã€‚</p>
<p><img alt="template-email" src="https://images.k8stech.net/template-email.png" /></p>
<h3 id="_4">å¼€æºè­¦æŠ¥ç»„ä»¶æ¨è<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="https://github.com/timonwong/prometheus-webhook-dingtalk">Prometheus-Webhook-Dingtalk</a></li>
</ul>
<p>ä¸€ä¸ªå¼€æºçš„ç¬¬ä¸‰æ–¹è­¦æŠ¥æ’ä»¶ï¼Œé’ˆå¯¹é’‰é’‰æœºå™¨äºº <code>webhook</code> åšé›†æˆï¼ŒGoè¯­è¨€ç¼–å†™ï¼Œç°åœ¨è¿­ä»£çš„å·²ç»å¾ˆä¸é”™äº†ï¼Œå¯èƒ½æœ‰ä¸€äº›åŠŸèƒ½è¿˜æ˜¯æœ‰äº›é™åˆ¶ï¼Œæ¯”å¦‚é’ˆå¯¹ <code>Markdown</code> @æŸä¸ªäººæ— æ³•å®ç°ï¼ŒåŸå› æ˜¯å› é’‰é’‰è‡ªèº«APIæ²¡æœ‰æ”¯æŒè¿™ä¸ªåŠŸèƒ½ã€‚</p>
<ul>
<li><a href="https://github.com/k8stech/alertmanager-wechatrobot-webhook.git">Alertmanager-wechatrobot-webhook</a></li>
</ul>
<p>è¿™ä¸ªå¼€æºç»„ä»¶æ˜¯å°†<code>Alertmanger</code> <code>Webhook</code> æ¶ˆæ¯è½¬æ¢ä¸ºå¯ä»¥æ¥æ”¶æ¶ˆæ¯çš„ä¼ä¸šå¾®ä¿¡æœºå™¨äººï¼Œä¹Ÿæ˜¯goè¯­è¨€ç¼–å†™ï¼Œ<code>Alertmanager</code> é»˜è®¤å·²ç»é›†æˆä¼ä¸šå¾®ä¿¡é…ç½®ï¼Œå¦‚æœæœ‰ç‰¹æ®Šéœ€æ±‚ï¼Œéœ€è¦ä½¿ç”¨ä¼ä¸šå¾®ä¿¡æœºå™¨äººçš„å¯ä»¥çœ‹çœ‹è¿™ä¸ªã€‚</p>
<ul>
<li><a href="https://github.com/feiyu563">PrometheusAlertå…¨å®¶æ¡¶</a></li>
</ul>
<p>å¦‚æœæœ‰å¯¹çŸ­ä¿¡ã€ç”µè¯è­¦æŠ¥ç­‰å…¶ä»–éœ€æ±‚çš„åŒå­¦ï¼Œæ¨èè¿™ä¸ªå¼€æºè­¦æŠ¥ç»„ä»¶ï¼ŒGoè¯­è¨€ç¼–å†™ï¼ŒWebæ¡†æ¶æ˜¯ <code>Beego</code> ï¼Œæ”¯æŒå°†æ”¶åˆ°çš„è¿™äº›æ¶ˆæ¯å‘é€åˆ°é’‰é’‰ï¼Œå¾®ä¿¡ï¼Œé£ä¹¦ï¼Œè…¾è®¯çŸ­ä¿¡ï¼Œè…¾è®¯ç”µè¯ï¼Œé˜¿é‡Œäº‘çŸ­ä¿¡ï¼Œé˜¿é‡Œäº‘ç”µè¯ï¼Œåä¸ºçŸ­ä¿¡ï¼Œå®¹è”äº‘ç”µè¯ç­‰ï¼Œè¿™é‡Œå°±ä¸ç»†è®²äº†ï¼Œå¦‚æœé…ç½®æœ‰é—®é¢˜å¯ä»¥éšæ—¶å’¨è¯¢æˆ‘ã€‚</p>
<p><img alt="promalert" src="https://images.k8stech.net/PrometheusAlert.png" /></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      



<!-- Application footer -->
<footer class="md-footer">

    <!-- Further information -->
    <div class="md-footer-meta md-typeset">
        <div class="md-footer-meta__inner md-grid">

            <!-- Copyright and theme information -->
            <div class="md-footer-copyright">
                
                <div class="md-footer-copyright__highlight">
                    Copyright &copy; 2020 KubernetesæŠ€æœ¯æ ˆ
                </div>
                
                powered by
                <a href="https://www.k8stech.net" title="KubernetesæŠ€æœ¯æ ˆ">www.k8stech.net</a>
            </div>

            <!-- Social links -->
            
            
            
        </div>
    </div>
</footer>


    </div>
    
      <script src="../../assets/javascripts/application.d9aa80ab.js"></script>
      
        
        
          
          <script src="../../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
              
                <script src="../../assets/javascripts/lunr/tinyseg.js"></script>
              
              
                <script src="../../assets/javascripts/lunr/lunr.jp.js"></script>
              
            
          
          
        
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
        <script src="../../assets/js/hljs/highlight.pack.js"></script>
      
        <script src="../../assets/js/prism.js"></script>
      
    
  </body>
</html>